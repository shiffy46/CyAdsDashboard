!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(r.science={})}(this,function(r){"use strict";function t(r,t){return r-t}function n(r){return r<1e-5&&r>-1e-5?r+.5*r*r:Math.exp(r)-1}function a(r){return"function"==typeof r?r:function(){return r}}function e(r,t){r=Math.abs(r),t=Math.abs(t);var n,a;r>t?(n=r,a=t):(n=t,a=r);var e=a/n;return n*Math.sqrt(1+e*e)}function f(){function r(r,n,a){var e=n*n-4*r*a;return e>0?(e=Math.sqrt(e)/(2*r),t?[{r:-n-e,i:0},{r:-n+e,i:0}]:[-n-e,-n+e]):0===e?(e=-n/(2*r),t?[{r:e,i:0}]:[e]):t?(e=Math.sqrt(-e)/(2*r),[{r:-n,i:-e},{r:-n,i:e}]):[]}var t=!1;return r.complex=function(n){return arguments.length?(t=n,r):t},r}function o(r){var t=-1,n=[];if(1===arguments.length)for(;++t<r;)n[t]=0;else for(;++t<r;)n[t]=o.apply(this,Array.prototype.slice.call(arguments,1));return n}function i(r,t){return[r[1]*t[2]-r[2]*t[1],r[2]*t[0]-r[0]*t[2],r[0]*t[1]-r[1]*t[0]]}function u(){function r(r){for(var t=r.length,n=[],a=[],e=[],f=0;f<t;f++)n[f]=[],a[f]=[],e[f]=[];for(var o=!0,i=0;i<t;i++)for(var f=0;f<t;f++)if(r[f][i]!==r[i][f]){o=!1;break}if(o){for(var f=0;f<t;f++)n[f]=r[f].slice();h(a,e,n),s(a,e,n)}else{for(var u=[],f=0;f<t;f++)u[f]=r[f].slice();v(u,n),c(a,e,u,n)}for(var l=[],f=0;f<t;f++){for(var M=l[f]=[],i=0;i<t;i++)M[i]=f===i?a[f]:0;l[f][e[f]>0?f+1:f-1]=e[f]}return{D:l,V:n}}return r}function h(r,t,n){for(var a=n.length,e=0;e<a;e++)r[e]=n[a-1][e];for(var f=a-1;f>0;f--){for(var o=0,i=0,u=0;u<f;u++)o+=Math.abs(r[u]);if(0===o){t[f]=r[f-1];for(var e=0;e<f;e++)r[e]=n[f-1][e],n[f][e]=0,n[e][f]=0}else{for(var u=0;u<f;u++)r[u]/=o,i+=r[u]*r[u];var h=r[f-1],s=Math.sqrt(i);h>0&&(s=-s),t[f]=o*s,i-=h*s,r[f-1]=h-s;for(var e=0;e<f;e++)t[e]=0;for(var e=0;e<f;e++){h=r[e],n[e][f]=h,s=t[e]+n[e][e]*h;for(var u=e+1;u<=f-1;u++)s+=n[u][e]*r[u],t[u]+=n[u][e]*h;t[e]=s}h=0;for(var e=0;e<f;e++)t[e]/=i,h+=t[e]*r[e];for(var v=h/(i+i),e=0;e<f;e++)t[e]-=v*r[e];for(var e=0;e<f;e++){h=r[e],s=t[e];for(var u=e;u<=f-1;u++)n[u][e]-=h*t[u]+s*r[u];r[e]=n[f-1][e],n[f][e]=0}}r[f]=i}for(var f=0;f<a-1;f++){n[a-1][f]=n[f][f],n[f][f]=1;var i=r[f+1];if(0!=i){for(var u=0;u<=f;u++)r[u]=n[u][f+1]/i;for(var e=0;e<=f;e++){for(var s=0,u=0;u<=f;u++)s+=n[u][f+1]*n[u][e];for(var u=0;u<=f;u++)n[u][e]-=s*r[u]}}for(var u=0;u<=f;u++)n[u][f+1]=0}for(var e=0;e<a;e++)r[e]=n[a-1][e],n[a-1][e]=0;n[a-1][a-1]=1,t[0]=0}function s(r,t,n){for(var a=n.length,f=1;f<a;f++)t[f-1]=t[f];t[a-1]=0;for(var o=0,i=0,u=0;u<a;u++){i=Math.max(i,Math.abs(r[u])+Math.abs(t[u]));for(var h=u;h<a&&!(Math.abs(t[h])<=1e-12*i);)h++;if(h>u)do{var s=r[u],v=(r[u+1]-s)/(2*t[u]),c=e(v,1);v<0&&(c=-c),r[u]=t[u]/(v+c),r[u+1]=t[u]*(v+c);for(var l=r[u+1],M=s-r[u],f=u+2;f<a;f++)r[f]-=M;o+=M,v=r[h];for(var b=1,g=b,d=b,p=t[u+1],m=0,w=0,f=h-1;f>=u;f--){d=g,g=b,w=m,s=b*t[f],M=b*v,c=e(v,t[f]),t[f+1]=m*c,m=t[f]/c,b=v/c,v=b*r[f]-m*s,r[f+1]=M+m*(b*s+m*r[f]);for(var q=0;q<a;q++)M=n[q][f+1],n[q][f+1]=m*n[q][f]+b*M,n[q][f]=b*n[q][f]-m*M}v=-m*w*d*p*t[u]/l,t[u]=m*v,r[u]=b*v}while(Math.abs(t[u])>1e-12*i);r[u]=r[u]+o,t[u]=0}for(var f=0;f<a-1;f++){for(var q=f,v=r[f],y=f+1;y<a;y++)r[y]<v&&(q=y,v=r[y]);if(q!=f){r[q]=r[f],r[f]=v;for(var y=0;y<a;y++)v=n[y][f],n[y][f]=n[y][q],n[y][q]=v}}}function v(r,t){for(var n=r.length,a=[],e=n-1,f=1;f<e;f++){for(var o=0,i=f;i<=e;i++)o+=Math.abs(r[i][f-1]);if(0!==o){for(var u=0,i=e;i>=f;i--)a[i]=r[i][f-1]/o,u+=a[i]*a[i];var h=Math.sqrt(u);a[f]>0&&(h=-h),u-=a[f]*h,a[f]=a[f]-h;for(var s=f;s<n;s++){for(var v=0,i=e;i>=f;i--)v+=a[i]*r[i][s];v/=u;for(var i=f;i<=e;i++)r[i][s]-=v*a[i]}for(var i=0;i<=e;i++){for(var v=0,s=e;s>=f;s--)v+=a[s]*r[i][s];v/=u;for(var s=f;s<=e;s++)r[i][s]-=v*a[s]}a[f]=o*a[f],r[f][f-1]=o*h}}for(var i=0;i<n;i++)for(var s=0;s<n;s++)t[i][s]=i===s?1:0;for(var f=e-1;f>=1;f--)if(0!==r[f][f-1]){for(var i=f+1;i<=e;i++)a[i]=r[i][f-1];for(var s=f;s<=e;s++){for(var h=0,i=f;i<=e;i++)h+=a[i]*t[i][s];h=h/a[f]/r[f][f-1];for(var i=f;i<=e;i++)t[i][s]+=h*a[i]}}}function c(r,t,n,a){for(var e,f,o,i,u=n.length,h=u-1,s=u-1,v=1e-12,c=0,M=0,b=0,g=0,d=0,p=0,m=0,w=0;w<u;w++){(w<0||w>s)&&(r[w]=n[w][w],t[w]=0);for(var q=Math.max(w-1,0);q<u;q++)m+=Math.abs(n[w][q])}for(var y=0;h>=0;){for(var k=h;k>0&&(d=Math.abs(n[k-1][k-1])+Math.abs(n[k][k]),0===d&&(d=m),!(Math.abs(n[k][k-1])<v*d));)k--;if(k===h)n[h][h]=n[h][h]+c,r[h]=n[h][h],t[h]=0,h--,y=0;else if(k===h-1){if(f=n[h][h-1]*n[h-1][h],M=(n[h-1][h-1]-n[h][h])/2,b=M*M+f,p=Math.sqrt(Math.abs(b)),n[h][h]=n[h][h]+c,n[h-1][h-1]=n[h-1][h-1]+c,o=n[h][h],b>=0){p=M+(M>=0?p:-p),r[h-1]=o+p,r[h]=r[h-1],0!==p&&(r[h]=o-f/p),t[h-1]=0,t[h]=0,o=n[h][h-1],d=Math.abs(o)+Math.abs(p),M=o/d,b=p/d,g=Math.sqrt(M*M+b*b),M/=g,b/=g;for(var q=h-1;q<u;q++)p=n[h-1][q],n[h-1][q]=b*p+M*n[h][q],n[h][q]=b*n[h][q]-M*p;for(var w=0;w<=h;w++)p=n[w][h-1],n[w][h-1]=b*p+M*n[w][h],n[w][h]=b*n[w][h]-M*p;for(var w=0;w<=s;w++)p=a[w][h-1],a[w][h-1]=b*p+M*a[w][h],a[w][h]=b*a[w][h]-M*p}else r[h-1]=o+M,r[h]=o+M,t[h-1]=p,t[h]=-p;h-=2,y=0}else{if(o=n[h][h],i=0,f=0,k<h&&(i=n[h-1][h-1],f=n[h][h-1]*n[h-1][h]),10==y){c+=o;for(var w=0;w<=h;w++)n[w][w]-=o;d=Math.abs(n[h][h-1])+Math.abs(n[h-1][h-2]),o=i=.75*d,f=-.4375*d*d}if(30==y&&(d=(i-o)/2,(d=d*d+f)>0)){d=Math.sqrt(d),i<o&&(d=-d),d=o-f/((i-o)/2+d);for(var w=0;w<=h;w++)n[w][w]-=d;c+=d,o=i=f=.964}y++;for(var z=h-2;z>=k&&(p=n[z][z],g=o-p,d=i-p,M=(g*d-f)/n[z+1][z]+n[z][z+1],b=n[z+1][z+1]-p-g-d,g=n[z+2][z+1],d=Math.abs(M)+Math.abs(b)+Math.abs(g),M/=d,b/=d,g/=d,z!=k)&&!(Math.abs(n[z][z-1])*(Math.abs(b)+Math.abs(g))<v*(Math.abs(M)*(Math.abs(n[z-1][z-1])+Math.abs(p)+Math.abs(n[z+1][z+1]))));)z--;for(var w=z+2;w<=h;w++)n[w][w-2]=0,w>z+2&&(n[w][w-3]=0);for(var x=z;x<=h-1;x++){var j=x!=h-1;if(x!=z&&(M=n[x][x-1],b=n[x+1][x-1],g=j?n[x+2][x-1]:0,0!=(o=Math.abs(M)+Math.abs(b)+Math.abs(g))&&(M/=o,b/=o,g/=o)),0==o)break;if(d=Math.sqrt(M*M+b*b+g*g),M<0&&(d=-d),0!=d){x!=z?n[x][x-1]=-d*o:k!=z&&(n[x][x-1]=-n[x][x-1]),M+=d,o=M/d,i=b/d,p=g/d,b/=M,g/=M;for(var q=x;q<u;q++)M=n[x][q]+b*n[x+1][q],j&&(M+=g*n[x+2][q],n[x+2][q]=n[x+2][q]-M*p),n[x][q]=n[x][q]-M*o,n[x+1][q]=n[x+1][q]-M*i;for(var w=0;w<=Math.min(h,x+3);w++)M=o*n[w][x]+i*n[w][x+1],j&&(M+=p*n[w][x+2],n[w][x+2]=n[w][x+2]-M*g),n[w][x]=n[w][x]-M,n[w][x+1]=n[w][x+1]-M*b;for(var w=0;w<=s;w++)M=o*a[w][x]+i*a[w][x+1],j&&(M+=p*a[w][x+2],a[w][x+2]=a[w][x+2]-M*g),a[w][x]=a[w][x]-M,a[w][x+1]=a[w][x+1]-M*b}}}}if(0!=m){for(h=u-1;h>=0;h--)if(M=r[h],0==(b=t[h])){var k=h;n[h][h]=1;for(var w=h-1;w>=0;w--){f=n[w][w]-M,g=0;for(var q=k;q<=h;q++)g+=n[w][q]*n[q][h];if(t[w]<0)p=f,d=g;else if(k=w,0===t[w]?n[w][h]=-g/(0!==f?f:v*m):(o=n[w][w+1],i=n[w+1][w],b=(r[w]-M)*(r[w]-M)+t[w]*t[w],e=(o*d-p*g)/b,n[w][h]=e,Math.abs(o)>Math.abs(p)?n[w+1][h]=(-g-f*e)/o:n[w+1][h]=(-d-i*e)/p),e=Math.abs(n[w][h]),v*e*e>1)for(var q=w;q<=h;q++)n[q][h]=n[q][h]/e}}else if(b<0){var k=h-1;if(Math.abs(n[h][h-1])>Math.abs(n[h-1][h]))n[h-1][h-1]=b/n[h][h-1],n[h-1][h]=-(n[h][h]-M)/n[h][h-1];else{var O=l(0,-n[h-1][h],n[h-1][h-1]-M,b);n[h-1][h-1]=O[0],n[h-1][h]=O[1]}n[h][h-1]=0,n[h][h]=1;for(var w=h-2;w>=0;w--){for(var A,P,I=0,N=0,q=k;q<=h;q++)I+=n[w][q]*n[q][h-1],N+=n[w][q]*n[q][h];if(f=n[w][w]-M,t[w]<0)p=f,g=I,d=N;else{if(k=w,0==t[w]){var O=l(-I,-N,f,b);n[w][h-1]=O[0],n[w][h]=O[1]}else{o=n[w][w+1],i=n[w+1][w],A=(r[w]-M)*(r[w]-M)+t[w]*t[w]-b*b,P=2*(r[w]-M)*b,0==A&0==P&&(A=v*m*(Math.abs(f)+Math.abs(b)+Math.abs(o)+Math.abs(i)+Math.abs(p)));var O=l(o*g-p*I+b*N,o*d-p*N-b*I,A,P);if(n[w][h-1]=O[0],n[w][h]=O[1],Math.abs(o)>Math.abs(p)+Math.abs(b))n[w+1][h-1]=(-I-f*n[w][h-1]+b*n[w][h])/o,n[w+1][h]=(-N-f*n[w][h]-b*n[w][h-1])/o;else{var O=l(-g-i*n[w][h-1],-d-i*n[w][h],p,b);n[w+1][h-1]=O[0],n[w+1][h]=O[1]}}if(e=Math.max(Math.abs(n[w][h-1]),Math.abs(n[w][h])),v*e*e>1)for(var q=w;q<=h;q++)n[q][h-1]=n[q][h-1]/e,n[q][h]=n[q][h]/e}}}for(var w=0;w<u;w++)if(w<0||w>s)for(var q=w;q<u;q++)a[w][q]=n[w][q];for(var q=u-1;q>=0;q--)for(var w=0;w<=s;w++){p=0;for(var x=0;x<=Math.min(q,s);x++)p+=a[w][x]*n[x][q];a[w][q]=p}}}function l(r,t,n,a){if(Math.abs(n)>Math.abs(a)){var e=a/n,f=n+e*a;return[(r+e*t)/f,(t-e*r)/f]}var e=n/a,f=a+e*n;return[(e*r+t)/f,(e*t-r)/f]}function M(r){var t=r[0].concat(r[1]).concat(r[2]).concat(r[3]);return t[12]*t[9]*t[6]*t[3]-t[8]*t[13]*t[6]*t[3]-t[12]*t[5]*t[10]*t[3]+t[4]*t[13]*t[10]*t[3]+t[8]*t[5]*t[14]*t[3]-t[4]*t[9]*t[14]*t[3]-t[12]*t[9]*t[2]*t[7]+t[8]*t[13]*t[2]*t[7]+t[12]*t[1]*t[10]*t[7]-t[0]*t[13]*t[10]*t[7]-t[8]*t[1]*t[14]*t[7]+t[0]*t[9]*t[14]*t[7]+t[12]*t[5]*t[2]*t[11]-t[4]*t[13]*t[2]*t[11]-t[12]*t[1]*t[6]*t[11]+t[0]*t[13]*t[6]*t[11]+t[4]*t[1]*t[14]*t[11]-t[0]*t[5]*t[14]*t[11]-t[8]*t[5]*t[2]*t[15]+t[4]*t[9]*t[2]*t[15]+t[8]*t[1]*t[6]*t[15]-t[0]*t[9]*t[6]*t[15]-t[4]*t[1]*t[10]*t[15]+t[0]*t[5]*t[10]*t[15]}function b(r,t){for(var n=0,a=-1,e=Math.min(r.length,t.length);++a<e;)n+=r[a]*t[a];return n}function g(r,t){t||(t=1e-10);for(var n,a,e=r.length,f=r[0].length,o=-1;++o<e;){var i=o;for(n=o;++n<e;)Math.abs(r[n][o])>Math.abs(r[i][o])&&(i=n);var u=r[o];if(r[o]=r[i],r[i]=u,Math.abs(r[o][o])<=t)return!1;for(n=o;++n<e;){var h=r[n][o]/r[o][o];for(a=o-1;++a<f;)r[n][a]-=r[o][a]*h}}for(o=e;--o>=0;){var h=r[o][o];for(n=-1;++n<o;)for(a=f;--a>=o;)r[n][a]-=r[o][a]*r[n][o]/h;for(r[o][o]/=h,a=e-1;++a<f;)r[o][a]/=h}return!0}function d(r){var t=r.length,n=-1;if(t===r[0].length){for(r=r.map(function(r,n){for(var a=new Array(t),e=-1;++e<t;)a[e]=n===e?1:0;return r.concat(a)}),g(r);++n<t;)r[n]=r[n].slice(t);return r}}function p(r){return Math.sqrt(b(r,r))}function m(r,t){var n,a,e=r.length,f=t[0].length,o=t.length,i=-1;if(o!==r[0].length)throw{error:"columns(a) != rows(b); "+r[0].length+" != "+o};for(var u=new Array(e);++i<e;)for(u[i]=new Array(f),n=-1;++n<f;){var h=0;for(a=-1;++a<o;)h+=r[i][a]*t[a][n];u[i][n]=h}return u}function w(r){var t=p(r);return r.map(function(r){return r/t})}function q(r){for(var t,n=r.length,a=r[0].length,e=-1,f=new Array(a);++e<a;)for(f[e]=new Array(n),t=-1;++t<n;)f[e][t]=r[t][e];return f}function y(r,t,n,a,e,f){var o,i;for(o=1;o<f;o++)i=r[o]/t[o-1],t[o]-=i*n[o-1],a[o]-=i*a[o-1];for(e[f-1]=a[f-1]/t[f-1],o=f-2;o>=0;o--)e[o]=(a[o]-n[o]*e[o+1])/t[o]}function k(r){var t=r<0?-1:1;r<0&&(t=-1,r=-r);var n=1/(1+.3275911*r);return t*(1-((((1.061405429*n-1.453152027)*n+1.421413741)*n-.284496736)*n+.254829592)*n*Math.exp(-r*r))}function z(){function r(){var r,e,f;do{r=2*t()-1,e=2*t()-1,f=r*r+e*e}while(f>=1||0===f);return n+a*r*Math.sqrt(-2*Math.log(f)/f)}var t=Math.random,n=0,a=1,e=1;return r.pdf=function(r){return r=(r-n)/a,ir*Math.exp(-.5*r*r)/a},r.cdf=function(r){return r=(r-n)/a,.5*(1+k(r/Math.SQRT2))},r.mean=function(t){return arguments.length?(n=+t,r):n},r.variance=function(t){return arguments.length?(a=Math.sqrt(e=+t),r):e},r.random=function(n){return arguments.length?(t=n,r):t},r}function x(r){var t=r.length;if(0===t)return NaN;for(var n=0,a=-1;++a<t;)n+=(r[a]-n)/(a+1);return n}function j(r){var t=r.length;if(t<1)return NaN;if(1===t)return 0;for(var n=x(r),a=-1,e=0;++a<t;){var f=r[a]-n;e+=f*f}return e/(t-1)}function O(r,n){r=r.slice().sort(t);var a=r.length-1;return n.map(function(t){if(0===t)return r[0];if(1===t)return r[a];var n=1+t*a,e=Math.floor(n),f=n-e,o=r[e-1];return 0===f?o:o+f*(r[e]-o)})}function A(r){var t=O(r,[.25,.75]);return t[1]-t[0]}function P(r){var t,n=Math.sqrt(j(r));return(t=Math.min(n,A(r)/1.34))||(t=n)||(t=Math.abs(r[1]))||(t=1),.9*t*Math.pow(r.length,-.2)}function I(r){var t=A(r)/1.34;return 1.06*Math.min(Math.sqrt(j(r)),t)*Math.pow(r.length,-.2)}function N(r,t){for(var n,a=r.length,e=-1,f=0;++e<a;)n=r[e]-t[e],f+=n*n;return Math.sqrt(f)}function R(r,t){for(var n=r.length,a=-1,e=0;++a<n;)e+=Math.abs(r[a]-t[a]);return e}function E(r){return function(t,n){for(var a=t.length,e=-1,f=0;++e<a;)f+=Math.pow(Math.abs(t[e]-n[e]),r);return Math.pow(f,1/r)}}function Q(r,t){for(var n,a=r.length,e=-1,f=0;++e<a;)(n=Math.abs(r[e]-t[e]))>f&&(f=n);return f}function S(r,t){for(var n=r.length,a=-1,e=0;++a<n;)r[a]!==t[a]&&e++;return e}function T(r,t){for(var n=r.length,a=-1,e=0;++a<n;)r[a]===t[a]&&e++;return e/n}function _(r,t){for(var n,a,e=r.length,f=-1,o=0,i=0;++f<e;)n=r[f],a=t[f],o+=Math.abs(n-a),i+=Math.abs(n+a);return o/i}function B(){function r(r){var a,e,f,o,i,u,h,s,v=r.length,c=[],l=[],M=[],b=[];for(h=-1;++h<v;)for(c[h]=0,M[h]=[],s=-1;++s<v;)M[h][s]=h===s?1/0:t(r[h],r[s]),M[h][c[h]]>M[h][s]&&(c[h]=s);for(h=-1;++h<v;)b[h]=[],b[h][0]={left:null,right:null,dist:0,centroid:r[h],size:1,depth:0},l[h]=1;for(i=0;i<v-1;i++){for(a=0,h=0;h<v;h++)M[h][c[h]]<M[a][c[a]]&&(a=h);e=c[a],f=b[a][0],o=b[e][0];var g={left:f,right:o,dist:M[a][e],centroid:D(f.size,f.centroid,o.size,o.centroid),size:f.size+o.size,depth:1+Math.max(f.depth,o.depth)};for(b[a].splice(0,0,g),l[a]+=l[e],s=0;s<v;s++)switch(n){case"single":M[a][s]>M[e][s]&&(M[s][a]=M[a][s]=M[e][s]);break;case"complete":M[a][s]<M[e][s]&&(M[s][a]=M[a][s]=M[e][s]);break;case"average":M[s][a]=M[a][s]=(l[a]*M[a][s]+l[e]*M[e][s])/(l[a]+l[s])}for(M[a][a]=1/0,h=0;h<v;h++)M[h][e]=M[e][h]=1/0;for(s=0;s<v;s++)c[s]==e&&(c[s]=a),M[a][s]<M[a][c[a]]&&(c[a]=s);u=g}return u}var t=N,n="single";return r.distance=function(n){return arguments.length?(t=n,r):t},r}function D(r,t,n,a){for(var e=[],f=r+n,o=t.length,i=-1;++i<o;)e[i]=(r*t[i]+n*a[i])/f;return e}function F(r){return r<=1&&r>=-1?.5:0}function L(r){return r<=1&&r>=-1?1-Math.abs(r):0}function U(r){return r<=1&&r>=-1?.75*(1-r*r):0}function V(r){if(r<=1&&r>=-1){var t=1-r*r;return.9375*t*t}return 0}function C(r){if(r<=1&&r>=-1){var t=1-r*r;return 35/32*t*t*t}return 0}function G(r){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*r*r)}function H(r){return r<=1&&r>=-1?Math.PI/4*Math.cos(Math.PI/2*r):0}function J(){function r(r,a){var f=e.call(this,n);return r.map(function(r){for(var a=-1,e=0,o=n.length;++a<o;)e+=t((r-n[a])/f);return[r,e/f/o]})}var t=G,n=[],e=I;return r.kernel=function(n){return arguments.length?(t=n,r):t},r.sample=function(t){return arguments.length?(n=t,r):n},r.bandwidth=function(t){return arguments.length?(e=a(t),r):e},r}function K(){function r(r){for(var e,f,o,i,u,h,s,v=r.length,c=[],l=[],M=1,b=0,g=X(a,r);M&&b<n;){for(o=-1;++o<a;)l[o]=0;for(f=-1;++f<v;){for(i=r[f],h=1/0,o=-1;++o<a;)(u=t.call(this,g[o],i))<h&&(h=u,s=o);l[c[f]=s]++}for(e=[],f=-1;++f<v;)if(i=c[f],null==(u=e[i]))e[i]=r[f].slice();else for(o=-1;++o<u.length;)u[o]+=r[f][o];for(o=-1;++o<a;)for(i=e[o],u=1/l[o],f=-1;++f<i.length;)i[f]*=u;for(M=0,o=-1;++o<a;)if(!W(e[o],g[o])){M=1;break}g=e,b++}return{assignments:c,centroids:g}}var t=N,n=1e3,a=1;return r.k=function(t){return arguments.length?(a=t,r):a},r.distance=function(n){return arguments.length?(t=n,r):t},r}function W(r,t){if(!r||!t||r.length!==t.length)return!1;for(var n=r.length,a=-1;++a<n;)if(r[a]!==t[a])return!1;return!0}function X(r,t){var n=t.length;if(r>n)return null;for(var a,e,f,o=[],i=[],u={},h=0,s=0;s<r;){if(h===n)return null;var v=Math.floor(Math.random()*n);if(!(v in u)){for(u[v]=1,h++,e=t[v],f=!0,a=0;a<s;a++)if(W(e,o[a])){f=!1;break}f&&(o[s]=e,i[s]=v,s++)}}return o}function Y(r){return O(r,[.5])[0]}function Z(){function r(r,e,f){var o,i=r.length;if(i!==e.length)throw{error:"Mismatched array lengths"};if(0==i)throw{error:"At least one point required."};if(arguments.length<3)for(f=[],o=-1;++o<i;)f[o]=1;if($(r),$(e),$(f),rr(r),1==i)return[e[0]];if(2==i)return[e[0],e[1]];var u=Math.floor(t*i);if(u<2)throw{error:"Bandwidth too small."};var h=[],s=[],v=[];for(o=-1;++o<i;)h[o]=0,s[o]=0,v[o]=1;for(var c=-1;++c<=n;){var l,M=[0,u-1];for(o=-1;++o<i;){l=r[o],o>0&&nr(r,f,o,M);for(var b=M[0],g=M[1],d=r[o]-r[b]>r[g]-r[o]?b:g,p=0,m=0,w=0,q=0,y=0,k=Math.abs(1/(r[d]-l)),z=b;z<=g;++z){var x=r[z],j=e[z],O=z<o?l-x:x-l,A=tr(O*k)*v[z]*f[z],P=x*A;p+=A,m+=P,w+=x*P,q+=j*A,y+=j*P}var I=m/p,N=q/p,R=y/p,E=w/p,Q=Math.sqrt(Math.abs(E-I*I))<a?0:(R-I*N)/(E-I*I),S=N-Q*I;h[o]=Q*l+S,s[o]=Math.abs(e[o]-h[o])}if(c===n)break;var T=Y(s);if(Math.abs(T)<a)break;var _,A;for(o=-1;++o<i;)_=s[o]/(6*T),v[o]=_>=1?0:(A=1-_*_)*A}return h}var t=.3,n=2,a=1e-12;return r.bandwidth=function(n){return arguments.length?(t=n,r):n},r.robustnessIterations=function(t){return arguments.length?(n=t,r):t},r.accuracy=function(t){return arguments.length?(a=t,r):t},r}function $(r){for(var t=r.length,n=-1;++n<t;)if(!isFinite(r[n]))return!1;return!0}function rr(r){for(var t=r.length,n=0;++n<t;)if(r[n-1]>=r[n])return!1;return!0}function tr(r){return(r=1-r*r*r)*r*r}function nr(r,t,n,a){var e=a[0],f=a[1],o=ar(t,f);if(o<r.length&&r[o]-r[n]<r[n]-r[e]){var i=ar(t,e);a[0]=i,a[1]=o}}function ar(r,t){for(var n=t+1;n<r.length&&0===r[n];)n++;return n}function er(r){for(var t,n,a={},e=[],f=0,o=r.length,i=-1;++i<o;)n=a.hasOwnProperty(t=r[i])?++a[t]:a[t]=1,n===f?e.push(t):n>f&&(f=n,e=[t]);if(1===e.length)return e[0]}function fr(r){return.5*(1+k(r/Math.SQRT2))}var or=Object.freeze({cross:i,decompose:u,determinant:M,dot:b,gaussjordan:g,inverse:d,length:p,multiply:m,normalize:w,transpose:q,tridag:y}),ir=1/Math.sqrt(2*Math.PI),ur=Object.freeze({gaussian:z}),hr=Object.freeze({nrd0:P,nrd:I}),sr=Object.freeze({euclidean:N,manhattan:R,minkowski:E,chebyshev:Q,hamming:S,jaccard:T,braycurtis:_}),vr=Object.freeze({uniform:F,triangular:L,epanechnikov:U,quartic:V,triweight:C,gaussian:G,cosine:H}),cr=sr,lr=vr,Mr=ur,br=hr,gr=Object.freeze({distance:cr,kernel:lr,distribution:Mr,bandwidth:br,erf:k,hcluster:B,iqr:A,kde:J,kmeans:K,loess:Z,mean:x,median:Y,mode:er,phi:fr,quantiles:O,variance:j}),dr=or,pr=gr;r.lin=dr,r.stats=pr,r.version="1.9.3",r.ascending=t,r.EULER=.5772156649015329,r.expm1=n,r.functor=a,r.hypot=e,r.quadratic=f,r.zeroes=o,Object.defineProperty(r,"__esModule",{value:!0})});